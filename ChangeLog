# do not edit -- automatically generated by arch changelog
# arch-tag: automatic-ChangeLog--lcourtes@laas.fr--2006-libre/guile-avahi--devo--0
#

2007-06-08 23:08:08 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-22

    Summary:
      Have call-backs run in Guile mode.
    Revision:
      guile-avahi--devo--0--patch-22

    * modules/Makefile.am (EXTRA_DIST): Added `avahi/build/callbacks.scm'.
    
    * src/Makefile.am (BUILT_SOURCES): Added
      `{client,publish,lookup}-callbacks.{h,i.c}'.
      (%-callbacks.h, %-callbacks.i.c): New rules.
    
    * src/client.c: Include "client-callbacks.h" and "client-callbacks.i.c".
      (client_trampoline): Renamed to `client_callback'.
      (scm_avahi_make_client): Use `client_callback_trampoline' instead of
      `client_callback'.
    
    * src/lookup.c: Likewise.
    
    * src/publish.c: Likewise.

    new files:
     modules/avahi/build/callbacks.scm src/make-callback-header.scm
     src/make-callback-trampolines.scm

    modified files:
     ChangeLog modules/Makefile.am src/Makefile.am src/client.c
     src/lookup.c src/publish.c

    new patches:
     lcourtes@laas.fr--2005-mobile/guile-avahi--devo--0--patch-3


2007-06-06 21:37:16 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-21

    Summary:
      Updated documentation snarfing code from GnuTLS.
    Revision:
      guile-avahi--devo--0--patch-21


    modified files:
     ChangeLog doc/extract-c-doc.scm
     modules/system/documentation/c-snarf.scm
     modules/system/documentation/output.scm

    new patches:
     lcourtes@laas.fr--2005-mobile/guile-avahi--devo--0--patch-2


2007-05-26 23:00:12 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-20

    Summary:
      Added resolvers, which finishes the `lookup' API.
    Revision:
      guile-avahi--devo--0--patch-20

    * modules/avahi/build/enums.scm (%resolver-event-enum): New.
      (%avahi-lookup-enums): Use it.
    
    * modules/avahi/client/lookup.scm: Updated.
    
    * src/lookup.c (SCM_AVAHI_*BROWSER*): Renamed to `SCM_AVAHI_*LOOKUP*' for
      generalization.
      (BROWSER_SMOB_MARK): Renamed to `SMOB_MARKER'.
      (BROWSER_CLIENT_ACCESSOR): Renamed to `CLIENT_ACCESSOR'.
      Added new SMOB markers and accessors.
      (scm_from_avahi_host_name): New macro.
      (service_resolver_trampoline, scm_avahi_make_service_resolver,
      host_name_resolver_trampoline, scm_avahi_make_host_name_resolver,
      address_resolver_trampoline, scm_avahi_make_address_resolver): New.
    
    * src/publish.c: Don't include <gmp.h> and <arpa/inet.h>.
      (scm_avahi_add_entry_group_address_x): Use `scm_to_avahi_address ()'
      rather than custom code.
    
    * src/utils.c: Include <gmp.h> and <arpa/inet.h>.
      (scm_from_avahi_address, scm_from_avahi_string_list,
      scm_to_avahi_address): New.
    
    * src/utils.h: Updated.
    
    * tests/Makefile.am (TESTS): Added `publish+resolve.scm'.
    
    * tests/publish+browse.scm: Fixed minor typos.

    new files:
     tests/publish+resolve.scm

    modified files:
     ChangeLog modules/avahi/build/enums.scm
     modules/avahi/client/lookup.scm src/lookup.c src/publish.c
     src/utils.c src/utils.h tests/Makefile.am
     tests/publish+browse.scm

    new patches:
     lcourtes@laas.fr--2005-mobile/guile-avahi--devo--0--base-0
     lcourtes@laas.fr--2005-mobile/guile-avahi--devo--0--patch-1


2007-05-24 23:16:30 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-19

    Summary:
      Updated the documentation.
    Revision:
      guile-avahi--devo--0--patch-19

    * doc/Makefile.am (BUILT_SOURCES): Added `lookup.c.texi'.
    
    * doc/guile-avahi.texi (Service Browsing): New node.
    
    * src/lookup.c: Fixed a couple of docstrings.

    modified files:
     ChangeLog doc/Makefile.am doc/guile-avahi.texi src/lookup.c


2007-05-24 23:14:56 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-18

    Summary:
      `(system documentation c-snarf)' fixes.
    Revision:
      guile-avahi--devo--0--patch-18

    * modules/system/documentation/c-snarf.scm
      (parse-documentation-item)[read-strings]: New procedure.
      Use it when reading `scheme-name', so that procedure names split into
      several C strings are properly read.
      Use it also for `documentation'; this fixes a bug since previously, it
      would not stop when a non-string is encountered.

    modified files:
     ChangeLog modules/system/documentation/c-snarf.scm


2007-05-24 22:41:13 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-17

    Summary:
      Added a test case for browsing.
    Revision:
      guile-avahi--devo--0--patch-17

    * tests/Makefile.am (TESTS): Added `publish+browse.scm'.

    new files:
     tests/publish+browse.scm

    modified files:
     ChangeLog tests/Makefile.am


2007-05-24 22:34:22 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-16

    Summary:
      Allow for `#f' as the domain argument of browsers.
    Revision:
      guile-avahi--devo--0--patch-16

    * src/lookup.c (scm_to_avahi_domain): New macro.
      (scm_avahi_make_domain_browser, scm_avahi_make_service_type_browser,
      scm_avahi_make_service_browser): Use it.

    modified files:
     ChangeLog src/lookup.c


2007-05-24 21:54:15 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-15

    Summary:
      Added support for all browsers.
    Revision:
      guile-avahi--devo--0--patch-15

    * modules/avahi/build/smobs.scm (%domain-browser-smob): Use
      `scm_avahi_domain_browser_free  ()' rather than
      `avahi_domain_browser_free ()'.
      (%service-browser-smob, %service-type-browser-smob,
      %service-resolver-smob, %host-name-resolver-smob,
      %address-resolver-smob): Likewise.
    
    * modules/avahi/client/lookup.scm: Updated.
    
    * src/lookup.c (SAFE_DESTRUCTOR): New macro.
      (SCM_AVAHI_SET_DOMAIN_BROWSER_*): Renamed to `SCM_AVAHI_SET_BROWSER_*'.
      (SCM_AVAHI_DOMAIN_BROWSER_*): Likewise.
      (BROWSER_MARK_SMOB, BROWSER_CLIENT_ACCESSOR): New.
      (service_type_browser_trampoline, scm_avahi_make_service_type_browser,
      service_browser_trampoline, scm_avahi_make_service_browser): New.

    modified files:
     ChangeLog modules/avahi/build/smobs.scm
     modules/avahi/client/lookup.scm src/lookup.c


2007-05-23 21:33:25 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-14

    Summary:
      Started support for the `lookup' interface.
    Revision:
      guile-avahi--devo--0--patch-14

    * README: Updated.
    
    * configure.ac: Don't abort when GMP's not found.  Look for
      `if_indextoname ()'.
    
    * modules/Makefile.am (nobase_dist_guilemodule_DATA): Added `lookup.scm'.
    
    * modules/avahi/build/enums.scm (%domain-browser-enum): Renamed to...
      (%domain-browser-type-enum): this.
      (%browser-event-enum, %avahi-lookup-enums): New.
    
    * modules/avahi/build/smobs.scm (%domain-browser-smob,
      %service-browser-smob, %service-type-browser-smob,
      %service-resolver-smob, %host-name-resolver-smob,
      %address-resolver-smob, %avahi-lookup-smobs): New.
    
    * src/.arch-inventory: Updated.
    
    * src/Makefile.am (BUILT_SOURCES): Added the `lookup' stuff.
      (libguile_avahi_v_0_la_SOURCES): Added `lookup.c'.
    
    * src/make-{enum,smob}-{header,types,map}.scm: Updated.
    
    * src/utils.c (scm_from_avahi_lookup_result_flags,
      scm_from_avahi_interface_index, scm_to_avahi_lookup_flags): New.
    
    * src/utils.h: Updated.

    new files:
     modules/avahi/client/lookup.scm src/lookup.c

    modified files:
     ChangeLog README configure.ac modules/Makefile.am
     modules/avahi/build/enums.scm modules/avahi/build/smobs.scm
     src/.arch-inventory src/Makefile.am src/make-enum-header.scm
     src/make-enum-map.scm src/make-smob-header.scm
     src/make-smob-types.scm src/utils.c src/utils.h


2007-05-23 19:45:55 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-13

    Summary:
      Updated the documentation.
    Revision:
      guile-avahi--devo--0--patch-13

    * doc/Makefile.am (BUILT_SOURCES): Added `publish.c.texi'.
    
    * doc/guile-avahi.texi (Service Publication): New.
    
    * src/common.c, src/publish.c: Small documentation fixes.

    modified files:
     ChangeLog doc/Makefile.am doc/guile-avahi.texi src/common.c
     src/publish.c


2007-05-21 22:46:12 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-12

    Summary:
      Finished `(avahi client publish)'.
    Revision:
      guile-avahi--devo--0--patch-12

    * configure.ac: Check for `net/if.h', `arpa/inet.h' and `gmp.h'.
      Check for `if_nametoindex ()' and `__gmpz_init ()'.
    
    * modules/Makefile.am (nobase_dist_guilemodule_DATA): Added
      `avahi/client/publish.scm'.
    
    * modules/avahi.scm: Updated.
    
    * modules/avahi/build/enums.scm (%protocol-enum, %interface-enum): New.
      (%avahi-common-enums): Use them.
    
    * modules/avahi/client/publish.scm: Updated.
    
    * src/client.c (client_trampoline): Invoke `SCM_SET_SMOB_DATA ()' if
      needed.
    
    * src/publish.h (mark_entry_group): Mark the client as well.
      (scm_avahi_make_entry_group): Attach CLIENT to GROUP.
      (scm_avahi_commit_entry_group, scm_avahi_reset_entry_group_x,
      scm_avahi_entry_group_state, scm_avahi_entry_group_empty_p,
      scm_avahi_add_entry_group_service_x,
      scm_avahi_add_entry_group_service_subtype_x,
      scm_avahi_update_entry_group_service_x,
      scm_avahi_add_entry_group_address_x, scm_avahi_alternative_host_name,
      scm_avahi_alternative_service_name): New.
    
    * src/utils.c: Use <net/inet.h> and "publish-enums.h".
      (scm_to_avahi_publish_flags, scm_to_avahi_interface_index): New.
    
    * src/utils.h (SCM_AVAHI_TO_C_STRING, scm_avahi_to_c_string): New macros.
    
    * tests/Makefile.am (TESTS): Added `publish.scm'.

    new files:
     tests/publish.scm

    modified files:
     ChangeLog configure.ac modules/Makefile.am modules/avahi.scm
     modules/avahi/build/enums.scm modules/avahi/client/publish.scm
     src/client.c src/publish.c src/utils.c src/utils.h
     tests/Makefile.am


2007-05-20 22:05:17 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-11

    Summary:
      Started support for service publication.
    Revision:
      guile-avahi--devo--0--patch-11

    * modules/avahi/build/enums.scm (%entry-group-state-enum,
      %publish-flag-enum, %avahi-publish-enums, %domain-browser-enum,
      %lookup-flag-enum, %avahi-browse-enums): New.
    
    * modules/avahi/build/smobs.scm (%entry-group-smob,
      %avahi-publish-smobs): New.
    
    * src/.arch-inventory: Updated.
    
    * src/Makefile.am (BUILT_SOURCES): Added `publish-{enums,smobs}.{h,i.c}'.
      (libguile_avahi_v_0_la_SOURCES): Added `publish.c'.
    
    * src/client.c (client_trampoline): Cast to `(void)' return of
      `scm_call_2 ()'.
    
    * src/make-enum-header.scm (main): Support `publish'.
    
    * src/make-enum-map.scm: Likewise.
    
    * src/make-smob-header.scm: Likewise.
    
    * src/make-smob-types.scm: Likewise.

    new files:
     modules/avahi/client/.arch-ids/=id
     modules/avahi/client/publish.scm src/publish.c

    modified files:
     ChangeLog modules/avahi/build/enums.scm
     modules/avahi/build/smobs.scm src/.arch-inventory
     src/Makefile.am src/client.c src/make-enum-header.scm
     src/make-enum-map.scm src/make-smob-header.scm
     src/make-smob-types.scm

    new directories:
     modules/avahi/client modules/avahi/client/.arch-ids


2007-05-18 17:52:27 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-10

    Summary:
      Documentation updates.
    Revision:
      guile-avahi--devo--0--patch-10


    modified files:
     ChangeLog doc/guile-avahi.texi src/client.c src/common.c


2007-05-18 17:07:06 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-9

    Summary:
      Added the error framework.
    Revision:
      guile-avahi--devo--0--patch-9

    * Makefile.am (SUBDIRS): Have `doc' after `src' so that everything's
      generated by then.
    
    * modules/avahi.scm: Updated.
    
    * modules/avahi/build/enums.scm (%error-enum): New.
      (%avahi-common-enums): Use it.
    
    * src/Makefile.am (noinst_HEADERS): Added `errors.h'.
      (BUILT_SOURCES): Added `errors.c.x'.
      (libguile_avahi_v_0_la_SOURCES): Added `errors.c'.
    
    * src/client.c: Include "errors.h".
      (scm_avahi_make_client): Use `scm_avahi_error ()'.
    
    * src/common.c: Include "errors.h".
      (scm_avahi_make_guile_poll, scm_avahi_make_simple_poll,
      scm_avahi_iterate_simple_poll, scm_avahi_run_simple_poll): Use
      `scm_avahi_error ()'.
      (scm_avahi_common_init): Call `scm_avahi_init_error ()'.
    
    * src/make-enum-header.scm (main): Define `AVAHI_ERR_OK'.
    
    * src/utils.c: Include "errors.h".
      (scm_from_avahi_watch_events): Use `scm_avahi_error ()'.
    
    * src/utils.h: Include "config.h".
      (EXPECT, NORETURN): New macros.
    
    * src/watch.c: Include "errors.h".
      (scm_avahi_invoke_watch, scm_avahi_invoke_timeout): Use
      `scm_avahi_error ()'.

    new files:
     src/errors.c src/errors.h

    modified files:
     ChangeLog Makefile.am modules/avahi.scm
     modules/avahi/build/enums.scm src/Makefile.am src/client.c
     src/common.c src/make-enum-header.scm src/utils.c src/utils.h
     src/watch.c


2007-05-18 16:13:24 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-8

    Summary:
      Added the documentation framework (from Guile-GnuTLS).
    Revision:
      guile-avahi--devo--0--patch-8

    * Makefile.am (SUBDIRS): Added `doc'.
    
    * configure.ac: Produce `doc/Makefile'.

    new files:
     doc/.arch-ids/=id doc/.arch-ids/Makefile.am.id
     doc/.arch-ids/extract-c-doc.scm.id doc/.arch-inventory
     doc/Makefile.am doc/extract-c-doc.scm doc/guile-avahi.texi

    modified files:
     ChangeLog Makefile.am configure.ac

    new directories:
     doc doc/.arch-ids


2007-05-18 15:36:49 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-7

    Summary:
      Added a `guile-poll' test.
    Revision:
      guile-avahi--devo--0--patch-7

    * tests/Makefile.am: Added `guile-poll.scm'.

    new files:
     tests/guile-poll.scm

    modified files:
     ChangeLog tests/Makefile.am


2007-05-18 15:35:27 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-6

    Summary:
      Augmented the poll API.
    Revision:
      guile-avahi--devo--0--patch-6

    * modules/avahi.scm: Updated.
    
    * src/watch.c: Include <assert.h>.
      (AvahiTimeout)[enabled]: New field.
      (watch_new): Don't assign the return value from Scheme to `stuff'.
      (watch_free): Use a single-argument callback.
      (timeout_new): Pass seconds and nanoseconds to the callback.  Check
      whether the timeout is actually enabled.
      (timeout_update): Likewise.
      (timeout_free): Use a single-argument callback.
      (mark_avahi_watch, mark_avahi_timeout): New.
      (scm_avahi_invoke_watch, scm_avahi_invoke_timeout): New.
      (apply_avahi_watch, apply_avahi_timeout): Removed.
      (scm_avahi_watch_fd, scm_avahi_watch_events, scm_avahi_watch_user_data,
      scm_avahi_set_watch_user_data_x, scm_avahi_timeout_value,
      scm_avahi_timeout_user_data, scm_avahi_set_timeout_user_data_x): New.

    modified files:
     ChangeLog modules/avahi.scm src/watch.c


2007-05-18 14:49:14 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-5

    Summary:
      Augmented the client API.
    Revision:
      guile-avahi--devo--0--patch-5

    * modules/avahi/client.scm: Updated.
    
    * src/client.c (SCM_AVAHI_SET_CLIENT_POLL, SCM_AVAHI_CLIENT_POLL): New
      macros.
      (mark_avahi_client): Mark the poll associated with CLIENT.
      (scm_avahi_make_client): Associate POLL with the newly-created client.
      (scm_avahi_client_server_version, scm_avahi_client_host_name,
      scm_avahi_client_host_fqdn, scm_avahi_client_state,
      scm_avahi_set_client_host_name_x): New.
    
    * tests/simple-poll.scm: Test the new `client-' procedures.

    modified files:
     ChangeLog modules/avahi/client.scm src/client.c
     tests/simple-poll.scm


2007-05-18 09:31:48 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-4

    Summary:
      Added a basic test framework.
    Revision:
      guile-avahi--devo--0--patch-4

    * Makefile.am (SUBDIRS): Added `tests'.
    
    * configure.ac: Removed `gl_EARLY' invocation.
      Produce `tests/Makefile'.
    
    * src/Makefile.am (noinst_HEADERS): Added "utils.h".
      (AM_CPPFLAGS): Added `-I$(srcdir)'.

    new files:
     tests/.arch-ids/=id tests/.arch-ids/Makefile.am.id
     tests/Makefile.am tests/simple-poll.scm

    modified files:
     ChangeLog Makefile.am configure.ac src/Makefile.am

    new directories:
     tests tests/.arch-ids


2007-05-17 15:50:57 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-3

    Summary:
      Client running with simple-poll.
    Revision:
      guile-avahi--devo--0--patch-3

    * src/common.c (iterate_args): New struct.
      (do_iterate, do_loop, scm_avahi_iterate_simple_poll,
      scm_avahi_run_simple_poll): New.
    
    * src/client.c (SCM_AVAHI_SET_CLIENT_CALLBACK): Take two args!
      (client_trampoline): Fixed.
      (scm_avahi_make_client): Call `SCM_AVAHI_SET_CLIENT_CALLBACK ()' before
      `avahi_client_new ()'.

    modified files:
     ChangeLog modules/avahi.scm src/client.c src/common.c


2007-05-17 14:47:07 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-2

    Summary:
      More stuff, nothing working yet.
    Revision:
      guile-avahi--devo--0--patch-2


    new files:
     src/utils.c src/utils.h

    modified files:
     ChangeLog modules/avahi.scm modules/avahi/build/enums.scm
     modules/avahi/client.scm src/Makefile.am src/client.c
     src/common.c src/make-enum-header.scm src/make-smob-header.scm
     src/watch.c src/watch.h


2007-05-17 14:45:04 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	patch-1

    Summary:
      SMOBs: Always initialize the whole SMOB double-cell.
    Revision:
      guile-avahi--devo--0--patch-1

    * modules/avahi/build/smobs.scm (output-c->smob-converter): Use
      `SCM_NEWSMOB3 ()' so that all components of the double-cell are
      initialized.

    modified files:
     ChangeLog modules/avahi/build/smobs.scm


2007-05-17 12:42:17 GMT	Ludovic Courtes <ludovic.courtes@laas.fr>	base-0

    Summary:
      Initial import: general framework, no function wrapped.
    Revision:
      guile-avahi--devo--0--base-0


    new files:
     AUTHORS COPYING ChangeLog Makefile.am NEWS README configure.ac
     modules/Makefile.am modules/avahi.scm
     modules/avahi/build/enums.scm modules/avahi/build/smobs.scm
     modules/avahi/build/utils.scm modules/avahi/client.scm
     modules/system/documentation/README
     modules/system/documentation/c-snarf.scm
     modules/system/documentation/output.scm pre-inst-guile.in
     src/Makefile.am src/client.c src/common.c
     src/make-enum-header.scm src/make-enum-map.scm
     src/make-smob-header.scm src/make-smob-types.scm src/watch.c
     src/watch.h


